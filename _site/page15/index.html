<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Curtis Larson's Blog &middot; A lot of software talk.
    
  </title>

  
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico?v=2">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Curtis Larson's Blog" href="/blog/atom.xml">

<!-- Mailchimp -->
  <link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
  <style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61702644-1', 'auto');
  ga('send', 'pageview');

</script>
  <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us11.list-manage.com","uuid":"1c8750215658512459a679f1e","lid":"29a072ab9b"}) })</script>
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/blog/" title="Blog">Curtis Larson's Blog</a>
           &nbsp;&nbsp;&nbsp;<small><a href="/">Main Site</a></small>
          
           &nbsp;&nbsp;&nbsp;
           <small><a href="/blog/archive">Archive</a></small>
          
           &nbsp;&nbsp;&nbsp;
           <small><a href="/blog/atom.xml">Feed</a></small>
          
        </h3>
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/blog/2015/08/08/meteor-mongodb-array-property-selector/">
        Meteor - MongoDB Object Array Property Selector
      </a>
    </h1>

    <time datetime="2015-08-08T00:00:00-04:00" class="post-date">08 Aug 2015</time>

    <h2 id="introduction">Introduction</h2>

<p>One slightly confusing question that I get asked sometimes and I see around the internet is how to select a document from a collection based on a property in an array of objects.</p>

<p>Suppose we have a <code>SimpleSchema</code> like so:</p>

<pre><code>Schema = {};

Schema.Task = new SimpleSchema({
  name: {
    type: String,
    label: "Task Name"
  },
  tags: {
    type: [Object],
    label: "Tags",
  },
  "tags.$.name": {
    type: String
  },
  "tags.$.rank": {
    type: Number
  }
});

Tasks.attachSchema(Schema.Task);
</code></pre>

<p>And we have inserted the following document:</p>

<pre><code>Tasks.insert({
  name: "Write Meteor Tutorial",
  tags: [
    {
      "name": "Meteor",
      "rank": 0
    },
    {
      "name": "Tutorial",
      "rank": 1
    }
  ]
});
</code></pre>

<p>And we want to select all the tasks that have a tag with the name “Meteor”. We can use the following syntax to perform this task:</p>

<pre><code>Tasks.find({
  "tags.name": "Meteor"
});
</code></pre>

<p>Notice how we did not include the <code>$</code> symbol that we used when specifying our <code>SimpleSchema</code>. Additionally if we only want to select the tags and not the entire <code>Tasks</code> object we can use a <code>fields</code> option.</p>

<pre><code>Tasks.find({
  "tags.name": "Meteor"
}, {
  fields: { "tags.$": 1}
});
</code></pre>

<p>The differing syntax may seem a bit confusing, but once you get the hang of it you can create some pretty powerful and complex schemas and selectors. Hope this helps anyone running into this problem!</p>

    
    
      <span>
          <a href="http://www.curtismlarson.com" target="_blank">Curtis Larson</a> |
          <a href="https://twitter.com/quackware" target="_blank">Twitter</a> |
          <a href="mailto:curtis@curtismlarson.com" target="_blank">Email</a>
      </span>
    
    <div id="mc_embed_signup">
<form action="//curtismlarson.us11.list-manage.com/subscribe/post?u=1c8750215658512459a679f1e&amp;id=29a072ab9b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <label for="mce-EMAIL">Subscribe to our mailing list</label>
  <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_1c8750215658512459a679f1e_29a072ab9b" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page16">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog/page14">Newer</a>
    
  
</div>

      </main>
      <footer class="footer">
        <small>
          &copy; <time datetime="2016-05-31T10:22:52-04:00">2016</time> Curtis Larson. All rights reserved.
        </small>
      </footer>
    </div>

  </body>
</html>
