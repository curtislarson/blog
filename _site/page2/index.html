<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Curtis Larson's Blog &middot; A lot of software talk.
    
  </title>

  
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico?v=2">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Curtis Larson's Blog" href="/blog/atom.xml">

<!-- Mailchimp -->
  <link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
  <style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61702644-1', 'auto');
  ga('send', 'pageview');

</script>
  <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us11.list-manage.com","uuid":"1c8750215658512459a679f1e","lid":"29a072ab9b"}) })</script>
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/blog/" title="Blog">Curtis Larson's Blog</a>
           &nbsp;&nbsp;&nbsp;<small><a href="/">Main Site</a></small>
          
           &nbsp;&nbsp;&nbsp;
           <small><a href="/blog/archive">Archive</a></small>
          
           &nbsp;&nbsp;&nbsp;
           <small><a href="/blog/atom.xml">Feed</a></small>
          
        </h3>
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/blog/2015/12/06/meteor-send-ical-email-invitation/">
        Meteor - How to Create and Send an iCal Invitation Email
      </a>
    </h1>

    <time datetime="2015-12-06T00:00:00-05:00" class="post-date">06 Dec 2015</time>

    <h2 id="introduction">Introduction</h2>

<p>In this tutorial I will show you how to send an iCal invitation email using basic Meteor packages and an iCal generator smart package. iCal files are useful because they allow the email recipient to instantly add the invitation or event to their calendar program directly form their email client. If you send emails with any sort of event information you should be sending an iCal file! The full source code for this tutorial is available on my <a href="https://github.com/quackware/meteor-send-invitation">GitHub page</a>.</p>

<h2 id="setup">Setup</h2>

<p>There are a few packages you need to get started</p>

<pre><code>meteor add email
meteor add quackware:ical-generator
</code></pre>

<p>The email package is pretty straightforward, it’s the basic email package provided by Meteor. The ical-generator is the npm package <a href="https://www.npmjs.com/package/ical-generator">ical-generator</a> that has been <a href="http://www.curtismlarson.com/blog/2015/11/20/meteor-wrap-publish-npm-package/">wrapped as a meteor smart package</a>. You can check out the source code of the smart package <a href="https://github.com/quackware/meteor-ical-generator">here</a>.</p>

<p>You also need to sign up for some sort of 3rd party email service (sendgrid, mandrill, etc) so that you can set your <code>MAIL_URL</code> variable in the server, allowing you to send emails. For this tutorial I used a mandrill account, but they are all very similar to use.</p>

<h2 id="client-side">Client Side</h2>

<p>The client side code for this tutorial is very basic. We just need to have a few fields in a form that we can submit to the server. You can see the <code>send-invitation.html</code> and <code>send-invitation.js</code> files below:</p>

<script src="https://gist.github.com/quackware/bdb509817ef76af80efa.js"></script>

<script src="https://gist.github.com/quackware/de8d369ff3f979989573.js"></script>

<p>These fields are just a sample of what you can include in an ical file. You can check out the documentation for ical-generator <a href="https://www.npmjs.com/package/ical-generator">here</a> which should give you a good idea of additional fields you might want to add.</p>

<h2 id="server-side">Server Side</h2>

<p>The first part of the server side code is setting up the <code>MAIL_URL</code> variable. I am setting it based on the user and password variables I have stored in my <code>settings.json</code> file:</p>

<script src="https://gist.github.com/quackware/30ce2c9b9a96440098a3.js"></script>

<p>You can read a more in depth discussion of setting up the <code>MAIL_URL</code> variable and the <code>settings.json</code> file in my <a href="http://www.curtismlarson.com/blog/2015/07/30/meteor-send-template-emails-from-server-mailgun/">send template emails from the server tutorial</a>. That tutorial uses mailgun, but mandrill works the exact same way.</p>

<p>We also need to implement the <code>sendInvitation</code> Meteor method we referenced in the client side code. This code uses our <code>quackware:ical-generator</code> package we already added.</p>

<script src="https://gist.github.com/quackware/34c8c0dab4d4de680ecd.js"></script>

<p>As you can see we create an empty ical object and then add an event to the calendar object populated with the data from the client side. We can then use <code>cal.toString()</code> to attach the ical file as an attachment using the built in <code>Email.send</code> function provided by Meteor. That’s it! Once you test it out and send an email you should see an email similar to the one below:</p>

<p><img src="http://i.imgur.com/s4uACyM.png" alt="Example Ical Email" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>Thats it! Meteor makes it very easy to both send emails and include additional packages like the ical-generator to add additional functionality to our application. Again the full source code for this tutorial is available on my <a href="https://github.com/quackware/meteor-send-invitation">GitHub page</a>. If you have any improvements or suggestions make sure to leave a comment!</p>

    
    
      <span>
          <a href="http://www.curtismlarson.com" target="_blank">Curtis Larson</a> |
          <a href="https://twitter.com/quackware" target="_blank">Twitter</a> |
          <a href="mailto:curtis@curtismlarson.com" target="_blank">Email</a>
      </span>
    
    <div id="mc_embed_signup">
<form action="//curtismlarson.us11.list-manage.com/subscribe/post?u=1c8750215658512459a679f1e&amp;id=29a072ab9b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
  <label for="mce-EMAIL">Subscribe to our mailing list</label>
  <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_1c8750215658512459a679f1e_29a072ab9b" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page3">Older</a>
  
  
    
      <a class="pagination-item newer" href="/blog">Newer</a>
    
  
</div>

      </main>
      <footer class="footer">
        <small>
          &copy; <time datetime="2015-12-11T10:30:42-05:00">2015</time> Curtis Larson. All rights reserved.
        </small>
      </footer>
    </div>

  </body>
</html>
